<!DOCTYPE html>
<script src="https://d3js.org/d3.v6.min.js"></script>

<style> 
        .chart rect {fill: steelblue;}
        #tooltip {
        	opacity: 0;
			position: absolute; 
            text-align: center;
			width: 60px; 
            height: 40px; 
            background: white; 
            border: 0px;
            }
</style>
   
<html>
    <head>
        <style>
        h1 {text-align: center;}
        h2 {text-align: center;}
        h4 {text-align: center;}
        p {text-align: center;}
        div {text-align: center;}
        </style>
    </head>
    
    <body onload='init()'>
        <h1>What is the recipe to a best selling video game?</h1>
        <h4>CS 416 Narrative Visualization by Isabella Iniguez</h4>
        <p>In this interactive slideshow, TBD </p>
        <p>Here in this first barplot, we can see the trends in what video game genres tend to sell the most. </p>
            <p>Hover over each bar to see how the numbers break down based on region!</p>
            
        <svg class = "chart" width="300" height="300"></svg>
        <div id="tooltip"></div>
        
        <script> // SCRIPT
            async function init(){
                var data = await d3.csv('https://iniguezisabella.github.io/data/genre_sales.csv');
                document.getElementById("data").innerHTML = data;

                var width = 500;
                var height = 250;
                
                var x = d3.scaleBand()
                .domain(data.map(d => d.Genre))
                .range([0, width])
                .padding(0.2);

                var y = d3.scaleLinear().domain([0,1800]).range([height,0])
                
                var margin = 75; // changed from 50
                
                var tooltip = d3.select("#tooltip");

                d3.select(".chart")
                .attr("width", width + 2*margin)
                .attr("height", height + 2*margin)
                .append("g")
                .attr("transform", "translate("+margin+","+margin+")")
                .selectAll('rect').data(data).enter().append('rect') //bars
                .attr("x",function(d,i) {return x(d.Genre);}) 
                .attr("y",function(d,i) {return y(d.Global_Sales);}) 
                .attr('width', x.bandwidth())
                .attr('height',function(d,i) {return height - y(d.Global_Sales);})
                .attr("fill", "#69b3a2")
                .on("mouseover", function(d,i) { // tooltip
                  tooltip.style("opacity", 1)
                    .style("left", (d3.event.pageX)+"px")
                    .style("top", (d3.event.pageY)+"рх")
                    .html("NA_Sales: " + i + " Million"); 
                 })
                 .on("mouseout", function() { tooltip.style("opacity", 0) })

                d3.select("svg").append("g")
                .attr("transform", "translate("+margin+","+margin+")")
                .call(d3.axisLeft(y));

                d3.select("svg").append("g")
                .attr("transform", "translate("+margin+","+(height+margin)+")")
                .call(d3.axisBottom(x))
                .selectAll("text")  
                .style("text-anchor", "end")
                .attr("dx", "-.8em")
                .attr("dy", ".15em")
                .attr("transform", "rotate(-65)");
            }
        </script>
    
          <p>Dataset: <a href="https://www.kaggle.com/datasets/gregorut/videogamesales">Kaggle</a> </p> 
    </body>
</html>

