<html>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <head>
        <style>
        h1 {text-align: center;}
        h2 {text-align: center;}
        h4 {text-align: center;}
        p {text-align: center;}
        div {text-align: center;}
        .dot {
            stroke: #000;
            stroke-width: 1px;
        }
        </style>
    
    </head>
    <body onload='init()'>
        <h1>What is the recipe to a best selling video game?</h1>
        <h4>CS 416 Narrative Visualization by Isabella Iniguez</h4>
        <h3>Global Sales by Platform</h3>
        <p>Is there somthing else at play here? Maybe where people are able tp play the game contributes to sales. In this barplot, we can see the trends in what video game platforms tend to sell the most. </p>
            <p>Hover over each bar to see how the numbers break down based on region!</p>
            <div id="chart"></div>
        <script>
            async function init(){
                const data = await d3.csv('https://iniguezisabella.github.io/data/meta_sales.csv');
                var width = 500;
                var height = 250;
                var x = d3.scaleBand()
                    .domain(data.map(d => d.metacritic))
                    .range([0, width])
                    .padding(0.2);
                var y = d3.scaleLinear()
                    .domain([0, 100])
                .domain(data.map(d => d.Global_Sales))
                    .nice()
                    .range([height, 0]);
                var margin = 75;
                const svg = d3.select("#chart")
                    .append("svg")
                    .attr("width", width + 2*margin)
                    .attr("height", height + 2*margin)
                    .append("g")
                    .attr("transform", "translate("+margin+","+margin+")")
                svg.append("g")
                    .attr("class", "y-axis")
                    .call(d3.axisLeft(y));
                svg.append("g")
                    .attr("class", "x-axis")
                    .attr("transform", "translate(0,"+(height)+")")
                    .call(d3.axisBottom(x))
                    .selectAll("text")  // tilt x-labels
                    .style("text-anchor", "end")
                    .attr("dx", "-.8em")
                    .attr("dy", ".15em")
                    .attr("transform", "rotate(-65)");
                
                    svg.selectAll(".dot")
                        .data(data)
                        .enter()
                        .append("circle")
                        .attr("class", "dot")
                        .attr("cx", d => x(d.metacritic))
                        .attr("cy", d => y(d.Global_Sales))
                        .attr("r", 3)
                        .on("mouseover", (event, d) => {
                            tooltip.transition().duration(200).style("opacity", .9);
                            tooltip.html(`Rating: ${d.metacritic}
                                        <br>Global Sales: ${d.Global_Sales}M`)
                                .style("left", (event.pageX + 5) + "px")
                                .style("top", (event.pageY - 28) + "px");
                        })
                        .on("mouseout", () => {
                            tooltip.transition().duration(500).style("opacity", 0);
                        });
            }
        </script>
        <div class="navbar">
            <a href="CS416NarViz-A.html">1</a>
            <a href="CS416NarViz-B.html">2</a>
            <a href="CS416NarViz-C.html">3</a>
            <a href="backup.html">test</a>
          </div>
    
          <p>Dataset: <a href="https://www.kaggle.com/datasets/gregorut/videogamesales">Kaggle</a> </p> 
    </body>
</html>